# Smoke testing of base utilities (FreeBSD)

Test generation tool made as a part of [Google Summer of Code '17 with FreeBSD](https://summerofcode.withgoogle.com/projects/#6426676740227072).  
**Refer the [FreeBSD wiki](https://wiki.freebsd.org/SummerOfCode2017/SmokeTestingOfBaseUtilities) for an overview and updates.**

## Directory Structure
```
.
└── src ........................:: Automation tool pertaining to new test plan
    ├── annotations
    │   └── ....................:: Annotation files (generated/user-defined)
    ├── scripts
    │   └── ....................:: Handy scripts
    ├── add_testcase.cpp .......:: Testcase generator
    ├── generate_license.cpp ...:: License generator
    ├── generate_test.cpp ......:: Test generator
    ├── read_annotations.cpp ...:: Annotation parser
    └── utils.cpp ..............:: Index generator
```

## Automation tool
An implementation of the automation tool briefly described [here](https://lists.freebsd.org/pipermail/soc-status/2017-July/001079.html).  
The following diagram summarizes how different components fit with the testcase-generator -  

![Automation-Tool](architecture.png)

- - -

## Dependencies
* Boost C++ libraries : The tool was tested to work with the port `boost-all-1.64.0`.

## Instructions

Clone the repository at `$HOME/smoketestsuite`.  
The location `$HOME/smoketestsuite` is important! If using a different location, the scripts under [src/scripts](src/scripts) need to be updated accordingly (for the time being).

### Populating groff scripts
* The directory [src/groff](src/groff) should be populated with the relevant groff scripts before proceeding for test generation. These scripts are available in the FreeBSD source tree. For filtering the utilities section wise, [fetch_groff.sh](src/scripts/fetch_groff.sh) sets the variable `section` to a default value of **1**. This value can be changed at will. However, it should be noted that currently the tool is tested to successfully generate **section 1 utilities** and might probably fail for other section numbers.

* The variable `src` in [fetch_groff.sh](src/scripts/fetch_groff.sh) should be updated to the location of the local FreeBSD source. The default value is `$HOME/freebsd`.

* For populating `src/groff`, execute the following inside [src](src) -
  ```
  make fetch_utils
  make fetch_groff
  ```

### Generating tests
Execute the following inside [src](src) -
```
make clean
make && make run
```
